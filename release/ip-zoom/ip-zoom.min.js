/*
	title	: ip-zoom.js
	version	: 20180115
	license	: GPLv3
	author	: Inpyo Jeon (inpyojeon@hmall.com)
*/

!function(t){t.fn.ipzoom=function(s){function e(t,i){var s=G.innerWidth(),e=x/s,a=t*e,n=i*e;at.css({width:x*e,height:H*e,top:-a,left:-n}),nt.each(v)}function a(t){return w.hasClass("_videoplay")?!1:(G.add(et).addClass("_active"),o(t),ot.show(),ct=setTimeout(function(){ot.fadeOut(400)},M),void 0)}function n(t){G.css({width:x/2,height:H/2}),G.add(et).removeClass("_active"),clearTimeout(ct),ct=0}function o(t){d(t);var i=parseInt(G.css("border-top-width")),s=G.innerWidth(),a=G.innerHeight(),n=lt-G.innerHeight()/2,o=dt-G.innerWidth()/2;0>n&&(n=0),n>H-a&&(n=H-a),0>o&&(o=0),o>x-s&&(o=x-s),G.css({top:n-i,left:o-i}),J.css({top:-n,left:-o}),e(n,o)}function r(t){var i=Z?-1*t.originalEvent.wheelDelta:t.originalEvent.wheelDelta,s=G.innerWidth(),e=G.innerHeight();return i>0?s*D>x/O?(s*=D,e*=D):(s=x/O,e=H/O):x>s*B?(s*=B,e*=B):(s=x,e=H),G.css({width:s,height:e}),o(t),!1}function d(t){var i=X.offset().top,s=X.offset().left;dt=t.pageX-s,lt=t.pageY-i}function l(){w.addClass("_loaded"),Y.add(st).each(v),c(),u(E)}function c(){for(i=0;i<Y.length;i++)Q[i]={cloneWidth:Y.eq(i).css("width"),cloneHeight:Y.eq(i).css("height"),cloneTop:Y.eq(i).css("top"),cloneLeft:Y.eq(i).css("left")}}function h(){var i=F.length>0?'<p class="_txt_notice">'+F+"</p>":"",s='<div class="_frm_input"></div><div class="_frm_overlay"></div><div class="_frm_magnifier"><div class="_frm_in_magnifier"><img class="_img_magnifier" src=""></div></div><div class="_frm_thumbnail"><a class="_nav_thumbnail_prev" href="javascript:;"></a><a class="_nav_thumbnail_next" href="javascript:;"></a><div class="_frm_in_thumbnail"><ul></ul></div></div><div class="_frm_output">'+i+'<div class="_frm_in_output"><img class="_img_output" src=""></div></div>';w.append(s).find("> img").addClass("_img_input").appendTo(w.find("._frm_input")).each(function(){w.find("._frm_in_thumbnail > ul").append('<li class="_wrap_thumbnail"><img class="_img_thumbnail" src="'+(t(this).data("thumbsrc")?t(this).data("thumbsrc"):t(this).attr("src"))+'"></li>')});for(var e=0;e<k.length;e++)w.find("._frm_overlay").append('<img class="_img_overlay _ioid_'+e+'" src="'+k[e]+'">');for(var e=0;P>e;e++)w.find("._wrap_thumbnail").eq(e).addClass("_showing");T&&(w.find("._frm_overlay").append('<div class="_vid_overlay"><div class="_vid_overlay_vid" id="'+y+'"></div></div>'),w.find("._frm_thumbnail").append('<div class="_wrap_videothumbnail"><img class="_img_vidthumbnail" src="'+I+'" onerror="this.src=\''+q+'\'"><img class="_btn_playvid" src="'+j+'"></div>'))}function m(){var t,i,s,e,a,n,o,r,d,l,c,h,m=parseInt(w.css("border-top-width")),_=w.css("border-top-color"),p=w.css("border-top-style"),f=w.css("background-color"),g=(parseInt(G.css("border-top-width")),parseInt($.css("border-top-width"))),u=0,v=0,b=-m,C=-m,y=parseInt(tt.css("width")),q=parseInt(tt.css("height")),j=parseInt(tt.css("border-top-width")),V=(parseInt(rt.css("border-top-width")),0),k=0,E=!N&&Y.length>P?2*E:0;if(T&&0==I.length&&w.find("._img_vidthumbnail").attr("src",Y.eq(0).attr("src")),F.length>0){var O=parseInt(ot.css("padding-left"));ot.addClass("_"+L),ot.css({width:x-2*O})}X.add(J).add(et).add(at).css({width:x,height:H,backgroundColor:f}),R.addClass("_"+z),et.addClass("_"+S),"top"==z||"bottom"==z?(l=parseInt(rt.css("margin-right")),c=(x+2*m-2*E-parseInt($.css("margin-right"))*(P-1)-g*P*2)/(P+1)-parseInt($.css("margin-right"))+l,E=N&&Y.length<=P?0:parseInt(R.css("padding-left")),t=T?x+2*m-2*E-c:x+2*m-2*E,n=parseInt($.css("margin-right")),e=(t-n*(P-1)-g*P*2)/P,a=e/W,i=a+2*g,q=a-2*j+2*g,v=T?e+n-m+l:-m,k=-v,"top"==z?(s=parseInt(R.css("padding-bottom")),u=-(i+s+m)):(s=parseInt(R.css("padding-top")),u=H+m,V=s)):(l=parseInt(rt.css("margin-bottom")),h=(H+2*m-2*E-parseInt($.css("margin-bottom"))*(P-1)-g*P*2)/(P+1)-parseInt($.css("margin-bottom"))+l,E=N&&Y.length<=P?0:parseInt(R.css("padding-top")),i=T?H+2*m-2*E-h:H+2*m-2*E,n=parseInt($.css("margin-bottom")),a=(i-n*(P-1)-g*P*2)/P,e=a*W,t=e+2*g,y=e-2*j+2*g,u=T?a+n-m+l:-m,V=-u,"left"==z?(s=parseInt(R.css("padding-right")),v=-(t+s+m)):(s=parseInt(R.css("padding-left")),v=x+m,k=s)),r=e,d=a,"top"==S?(o=parseInt(et.css("margin-bottom")),b=-(o+m)):"bottom"==S?(o=parseInt(et.css("margin-top")),b=H+m):"left"==S?(o=parseInt(et.css("margin-right")),C=-(o+m+x)):(o=parseInt(et.css("margin-left")),C=x+m),R.css({width:t,height:i,top:u,left:v}),$.css({width:e,height:a,backgroundColor:f}),et.css({top:b,left:C,borderWidth:m,borderColor:_,borderStyle:p}),G.css({width:x/2,height:H/2}),tt.add(it).css({width:y,height:q}),N&&Y.length<=P&&R.addClass("_hideComponent"),rt.css({width:r,height:d,left:k,top:V});var B=parseInt(w.css("margin-"+z)),D="top"==z||"bottom"==z?i+s:t+s;w.css("margin-"+z,B+D)}function _(){f(),u(t(this).index())}function p(){rt.addClass("_active"),Y.add($).removeClass("_active"),w.addClass("_videoplay"),jwplayer(y).play(!0)}function f(){T&&(rt.removeClass("_active"),w.removeClass("_videoplay"),jwplayer(y).stop())}function g(){var i=t(this),s="top"==z||"bottom"==z?$.eq(E-1).position().left:$.eq(E-1).position().top,e="top"==z||"bottom"==z?$.eq(E+2-P).position().left:$.eq(E+2-P).position().top;f(),i.hasClass("_nav_thumbnail_prev")?E>0&&($.eq(E-1).hasClass("_showing")||("top"==z||"bottom"==z?U.find("ul").css({left:-s}):U.find("ul").css({top:-s}),$.eq(E-1).addClass("_showing"),$.eq(E-1+P).removeClass("_showing")),u(E-1)):E<Y.length-1&&($.eq(E+1).hasClass("_showing")||("top"==z||"bottom"==z?U.find("ul").css({left:-e}):U.find("ul").css({top:-e}),$.eq(E+1).addClass("_showing"),$.eq(E+1-P).removeClass("_showing")),u(E+1))}function u(t){Y.eq(t).add($.eq(t)).addClass("_active").siblings().removeClass("_active"),nt.add(K).attr("src",Y.eq(t).attr("src")).css({width:Q[t].cloneWidth,height:Q[t].cloneHeight,top:Q[t].cloneTop,left:Q[t].cloneLeft}),0==t?tt.addClass("_deactive"):tt.removeClass("_deactive"),t==Y.length-1?it.addClass("_deactive"):it.removeClass("_deactive"),E=t}function v(){var i=t(this),s=b(i[0]).width,e=b(i[0]).height,a=s/e,n=i.parent().innerWidth(),o=i.parent().innerHeight(),r=n/o;i.css({top:0,left:0,width:"auto",height:"auto"}),"fit"==V&&a>r||"cover"==V&&r>a?i.css({width:n,top:(o-n/a)/2}):i.css({height:o,left:(n-o*a)/2})}function b(t){var i=new Image;return i.src=t.src,{width:i.width,height:i.height}}var w=t(this).addClass("mallzoom_object"),C=t.extend({imageFitType:"fit",thumbPosition:"bottom",thumbCount:5,outputPosition:"right",imageOverlay:[],zoomScale:.05,zoomMaximum:5,noticeText:"",noticePosition:"bottom",noticeShowTime:2,autoHideNav:!1,reverseZoom:!1,jwplayVidId:"",jwplayVidThumb:"",jwplayVidError:"http://image.hyundaihmall.com/hmall/pd/no_image_100x100.jpg",jwplayVidButton:"http://image.hyundaihmall.com/hmall/pd/product_60x60_movie.png"},s),y=C.jwplayVidId,I=C.jwplayVidThumb,q=C.jwplayVidError,j=C.jwplayVidButton,T=y.length>0,x=w.innerWidth(),H=w.innerHeight(),W=x/H,V=C.imageFitType,z=C.thumbPosition,P=T?C.thumbCount-1:C.thumbCount,S=C.outputPosition,k=C.imageOverlay,E=0,O=C.zoomMaximum,B=1+C.zoomScale,D=1-C.zoomScale,F=C.noticeText,L=C.noticePosition,M=1e3*C.noticeShowTime,N=C.autoHideNav,Z=C.reverseZoom,Q=[];h();var X=w.find("._frm_input"),Y=w.find("._img_input"),A=w.find("._frm_overlay"),G=(w.find("._img_overlay"),w.find("._frm_magnifier")),J=w.find("._frm_in_magnifier"),K=w.find("._img_magnifier"),R=w.find("._frm_thumbnail"),U=w.find("._frm_in_thumbnail"),$=w.find("._wrap_thumbnail"),tt=w.find("._nav_thumbnail_prev"),it=w.find("._nav_thumbnail_next"),st=w.find("._img_thumbnail"),et=w.find("._frm_output"),at=w.find("._frm_in_output"),nt=w.find("._img_output"),ot=w.find("._txt_notice"),rt=(w.find("._vid_overlay"),w.find("._wrap_videothumbnail"));m();var dt,lt,ct=0;return t(window).on("load",l),$.on("mouseenter",_),rt.on("mouseenter",p),tt.add(it).on("click",g),A.on("mouseenter",a),G.add(w).on("mouseleave",n),G.on("mousemove",o),G.on("mousewheel",r),this}}(jQuery);